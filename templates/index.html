<!DOCTYPE html>
<html>
<head>
    <title>Family Chat</title>
    <style>
        body { font-family: Arial; background:#f0f2f5; text-align:center; padding:30px; }
        h1 { margin-bottom:20px; }
        #chat { width:80%; max-width:600px; height:400px; border:1px solid #ccc; border-radius:10px; background:#fff; overflow-y:auto; margin:auto; padding:10px; }
        #controls { margin-top:15px; }
        #message { width:60%; padding:10px; font-size:16px; }
        #send { padding:10px 20px; font-size:16px; background:#4CAF50; color:white; border:none; border-radius:5px; cursor:pointer; }
        #send:hover { background:#45a049; }
        p { text-align:left; margin:5px 0; }
    </style>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <h1>ðŸ‘ª Family Chat</h1>
    <div id="chat">
        {% for u, m in messages %}
            <p><strong>{{ u }}:</strong> {{ m }}</p>
        {% endfor %}
    </div>
    <div id="controls">
        <input id="message" placeholder="Type a message..." />
        <button id="send">Send</button>
    </div>

    <script>
        const socket = io();
        const chat = document.getElementById("chat");
        const input = document.getElementById("message");
        const button = document.getElementById("send");

        let username = prompt("Enter your name:");
        if (!username || username.trim() === "") username = "Guest";

        button.onclick = sendMessage;
        input.addEventListener("keypress", function(e){
            if(e.key==="Enter"){ e.preventDefault(); sendMessage(); }
        });

        function sendMessage(){
            if(input.value.trim() !== ""){
                const fullMsg = username + ": " + input.value;
                socket.emit("message", fullMsg);
                input.value="";
            }
        }

        socket.on("message", function(msg){
            let p = document.createElement("p");
            p.textContent = msg;
            chat.appendChild(p);
            chat.scrollTop = chat.scrollHeight;
        });
    </script>
</body>
</html>
